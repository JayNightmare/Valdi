(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[702],{866:function(e,t,s){Promise.resolve().then(s.bind(s,8458))},8458:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return u}});var a=s(7437),l=s(2265),n=s(2120),c=s(7688),o=s(9212),i=s.n(o);s(4630);let r=(0,c.Zt)(i());function d(e){let{events:t}=e;return(0,a.jsx)("div",{className:"h-[600px] bg-white p-4 shadow rounded-lg",children:(0,a.jsx)(c.f,{localizer:r,events:t,startAccessor:"start",endAccessor:"end",style:{height:"100%"},views:["month","week","day"],defaultView:"week"})})}function u(){let[e,t]=(0,l.useState)([]),[s,c]=(0,l.useState)([]),[o,i]=(0,l.useState)(!0),[r,u]=(0,l.useState)(new Set);(0,l.useEffect)(()=>{(async()=>{try{let e=localStorage.getItem("valdi_token")||"",s=await n.h.getModules(e,[]);t(s);let a=new Set(s.map(e=>e.code));u(a)}catch(e){console.error("Failed to fetch data",e)}finally{i(!1)}})()},[]),(0,l.useEffect)(()=>{c(e.filter(e=>r.has(e.code)).flatMap(e=>e.schedule))},[r,e]);let h=e=>{let t=new Set(r);t.has(e)?t.delete(e):t.add(e),u(t)};return o?(0,a.jsx)("div",{className:"flex h-full items-center justify-center",children:"Loading timetable..."}):(0,a.jsxs)("div",{className:"flex h-[calc(100vh-100px)] gap-6",children:[(0,a.jsxs)("div",{className:"w-64 flex-shrink-0 overflow-y-auto rounded-lg border border-gray-200 bg-white p-4 shadow-sm",children:[(0,a.jsx)("h2",{className:"mb-4 text-lg font-semibold",children:"Modules"}),(0,a.jsx)("div",{className:"space-y-2",children:e.map(e=>(0,a.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,a.jsx)("input",{type:"checkbox",id:e.id,checked:r.has(e.code),onChange:()=>h(e.code),className:"mt-1 h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),(0,a.jsxs)("label",{htmlFor:e.id,className:"text-sm text-gray-700 cursor-pointer select-none",children:[(0,a.jsx)("span",{className:"font-medium",children:e.code}),(0,a.jsx)("br",{}),(0,a.jsx)("span",{className:"text-xs text-gray-500 line-clamp-2",children:e.name})]})]},e.id))})]}),(0,a.jsxs)("div",{className:"flex-1 flex flex-col space-y-6 overflow-hidden",children:[(0,a.jsxs)("header",{className:"flex-shrink-0",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold leading-tight tracking-tight text-gray-900",children:"My Timetable"}),(0,a.jsxs)("p",{className:"text-gray-500",children:[s.length," events showing"]})]}),(0,a.jsx)("div",{className:"flex-1 min-h-0",children:(0,a.jsx)(d,{events:s})})]})]})}},2120:function(e,t,s){"use strict";s.d(t,{h:function(){return i}});var a=s(9212),l=s.n(a);function n(e){let t=[],s="",a=!1;for(let l=0;l<e.length;l++){let n=e[l];'"'===n?a&&'"'===e[l+1]?(s+='"',l++):a=!a:","!==n||a?s+=n:(t.push(s),s="")}return t.push(s),t}let c=async e=>{try{let t=await fetch(e),s=(await t.text()).split("\n"),a=s.findIndex(e=>e.includes('"Description","Module code"'));if(-1===a)return console.error("Could not find header row in CSV:",e),[];let c=n(s[a]).map(e=>e.trim()),o=[];for(let e=a+1;e<s.length;e++){let t=s[e].trim();if(!t)continue;let a=n(t),i={};if(c.forEach((e,t)=>{i[e]=a[t]||""}),!i["Start date"]||!i["Start time"])continue;let r=l()("".concat(i["Start date"]," ").concat(i["Start time"]),"YYYY-MM-DD HH:mm").toDate(),d=l()("".concat(i["End date"]," ").concat(i["End time"]),"YYYY-MM-DD HH:mm").toDate();o.push({id:"".concat(i["Module code"],"-").concat(e),title:i.Description,start:r,end:d,location:i["Room(s)"],type:i.Type,moduleCode:i["Module code"]})}return o}catch(e){return console.error("Error fetching/parsing CSV:",e),[]}},o=["/data/specific/CompSci-Level4_timetable_2526.csv","/data/specific/CompSci-Level5_timetable_2526.csv","/data/specific/CompSci-Level6_timetable_2526.csv"],i={login:async e=>new Promise(t=>{setTimeout(()=>{t({username:e,token:"mock-token-123"})},500)}),getCourses:async e=>[],getModules:async(e,t)=>{let s=o.map(e=>c(e)),a=(await Promise.all(s)).flat(),l=new Map;return a.forEach(e=>{var t;l.has(e.moduleCode)||l.set(e.moduleCode,{id:e.moduleCode,name:e.title.split("(")[0].trim(),code:e.moduleCode,courseId:"unknown",schedule:[]}),null===(t=l.get(e.moduleCode))||void 0===t||t.schedule.push(e)}),Array.from(l.values())}}}},function(e){e.O(0,[234,990,856,69,971,23,744],function(){return e(e.s=866)}),_N_E=e.O()}]);